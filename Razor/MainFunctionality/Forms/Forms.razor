@page "/forms"
@using FormsClone.CSharp.MainFunctionality.Interfaces
@using FormsClone.CSharp.MainFunctionality.Forms.Models
@inject IEntityService<Form> FormsService
@inject NavigationManager NavigationManager

<h3>Формы</h3>

<!-- Кнопка для создания формы -->
<button class="btn btn-primary" @onclick="CreateForm">Создать Форму</button>

@if (forms != null && forms.Any())
{
    <ul class="list-group mt-3">
        @foreach (var form in forms)
        {
            <li class="list-group-item d-flex justify-content-between align-items-center">
                @form.Name
                <div>
                    <button class="btn btn-warning btn-sm" @onclick="() => EditForm(form.ID)">Редактировать</button>
                    <button class="btn btn-danger btn-sm" @onclick="() => DeleteForm(form.ID)">Удалить</button>
                </div>
            </li>
        }
    </ul>
}
else
{
    <p>Нет доступных форм.</p>
}

@code {
    private List<Form>? forms;

    protected override async Task OnInitializedAsync()
    {
        forms = await FormsService.GetAllAsync();
    }

    private void CreateForm()
    {
        NavigationManager.NavigateTo("/create-form");
    }

    private void EditForm(string id)
    {
        NavigationManager.NavigateTo($"/edit-form/{id}");
    }

    private async Task DeleteForm(string id)
    {
        await FormsService.DeleteAsync(int.Parse(id));
        forms = await FormsService.GetAllAsync();
    }
}
